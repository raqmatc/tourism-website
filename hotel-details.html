<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>تفاصيل الفندق - Paygo</title>

  <!-- إضافة خط Cairo من Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@200..1000&display=swap" rel="stylesheet">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
  
  <!-- إضافة Font Awesome للأيقونات -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

  <style>
  html, body {
    min-height: 100vh;
    margin: 0;
    padding: 0;
    font-family: 'Cairo', sans-serif;
    color: #000;
    background-color: #f8f9fa;
  }

  .navbar {
    background-color: #222;
    height: 60px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 20px;
    position: sticky;
    top: 0;
    z-index: 1000;
  }

  .navbar img {
    height: 54px;
    width: auto;
    object-fit: contain;
  }

  .back-btn {
    background: #667eea;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 20px;
    cursor: pointer;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 8px;
    font-size: 0.9rem;
  }

  .back-btn:hover {
    background: #5a6fd8;
    color: white;
    text-decoration: none;
  }

  .hotel-header {
    background: white;
    padding: 0;
    margin-bottom: 20px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }

  .hotel-gallery {
    position: relative;
    height: 400px;
    overflow: hidden;
  }

  .main-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    cursor: pointer;
  }

  .gallery-thumbnails {
    position: absolute;
    bottom: 15px;
    right: 15px;
    display: flex;
    gap: 8px;
    max-width: 300px;
    overflow-x: auto;
  }

  .thumbnail {
    width: 60px;
    height: 45px;
    object-fit: cover;
    border-radius: 5px;
    cursor: pointer;
    border: 2px solid transparent;
    transition: all 0.3s ease;
  }

  .thumbnail:hover, .thumbnail.active {
    border-color: #fff;
    transform: scale(1.1);
  }

  .gallery-overlay {
    position: absolute;
    bottom: 15px;
    left: 15px;
    background: rgba(0,0,0,0.7);
    color: white;
    padding: 8px 12px;
    border-radius: 20px;
    font-size: 0.9rem;
    cursor: pointer;
  }

  .hotel-info-section {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
  }

  .hotel-title {
    background: white;
    padding: 25px;
    border-radius: 15px;
    margin-bottom: 20px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }

  .hotel-name {
    font-size: 2rem;
    font-weight: bold;
    color: #333;
    margin-bottom: 10px;
  }

  .hotel-rating {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 15px;
  }

  .stars {
    color: #ffc107;
    font-size: 1.2rem;
  }

  .rating-score {
    background: #667eea;
    color: white;
    padding: 5px 12px;
    border-radius: 20px;
    font-weight: bold;
  }

  .hotel-location {
    color: #666;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 1.1rem;
  }

  .content-grid {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 20px;
    margin-bottom: 30px;
  }

  .hotel-details {
    background: white;
    padding: 25px;
    border-radius: 15px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }

  .section-title {
    font-size: 1.3rem;
    font-weight: bold;
    color: #333;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 2px solid #f0f0f0;
  }

  .hotel-description {
    line-height: 1.8;
    color: #555;
    margin-bottom: 25px;
  }

  .amenities-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
    margin-bottom: 25px;
  }

  .amenity-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px;
    background: #f8f9fa;
    border-radius: 8px;
  }

  .amenity-icon {
    color: #667eea;
    font-size: 1.1rem;
  }

  .booking-card {
    background: white;
    padding: 25px;
    border-radius: 15px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    position: sticky;
    top: 80px;
    height: fit-content;
  }

  .price-section {
    text-align: center;
    margin-bottom: 20px;
  }

  .price-from {
    color: #666;
    font-size: 0.9rem;
  }

  .price-amount {
    font-size: 2.5rem;
    font-weight: bold;
    color: #ff6b6b;
    margin: 5px 0;
  }

  .price-per-night {
    color: #999;
    font-size: 0.85rem;
  }

  .booking-form {
    margin-bottom: 20px;
  }

  .form-group {
    margin-bottom: 15px;
  }

  .form-group label {
    display: block;
    margin-bottom: 5px;
    font-weight: 600;
    color: #333;
  }

  .form-control {
    width: 100%;
    padding: 10px;
    border: 2px solid #e1e5e9;
    border-radius: 8px;
    font-size: 0.9rem;
  }

  .form-control:focus {
    outline: none;
    border-color: #667eea;
  }

  .book-now-btn {
    background: linear-gradient(135deg, #28a745, #20c997);
    color: white;
    border: none;
    padding: 15px;
    border-radius: 25px;
    cursor: pointer;
    font-weight: bold;
    font-size: 1.1rem;
    width: 100%;
    transition: all 0.3s ease;
  }

  .book-now-btn:hover {
    background: linear-gradient(135deg, #218838, #1ea085);
    transform: translateY(-2px);
  }

  .reviews-section {
    background: white;
    padding: 25px;
    border-radius: 15px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    margin-bottom: 20px;
  }

  .review-item {
    padding: 15px 0;
    border-bottom: 1px solid #f0f0f0;
  }

  .review-item:last-child {
    border-bottom: none;
  }

  .review-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
  }

  .reviewer-name {
    font-weight: bold;
    color: #333;
  }

  .review-date {
    color: #999;
    font-size: 0.85rem;
  }

  .review-rating {
    color: #ffc107;
    margin-bottom: 8px;
  }

  .review-text {
    color: #555;
    line-height: 1.6;
  }

  .map-section {
    background: white;
    padding: 25px;
    border-radius: 15px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    margin-bottom: 20px;
  }

  .map-placeholder {
    height: 300px;
    background: #f0f0f0;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #666;
    font-size: 1.1rem;
  }

  /* Modal للمعرض */
  .gallery-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.9);
    z-index: 10000;
    justify-content: center;
    align-items: center;
  }

  .modal-content {
    position: relative;
    max-width: 90%;
    max-height: 90%;
  }

  .modal-image {
    width: 100%;
    height: auto;
    border-radius: 10px;
  }

  .modal-close {
    position: absolute;
    top: -40px;
    right: 0;
    background: none;
    border: none;
    color: white;
    font-size: 2rem;
    cursor: pointer;
  }

  .modal-nav {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(255,255,255,0.2);
    border: none;
    color: white;
    font-size: 2rem;
    padding: 10px 15px;
    cursor: pointer;
    border-radius: 50%;
  }

  .modal-prev {
    left: -60px;
  }

  .modal-next {
    right: -60px;
  }

  /* أنماط متجاوبة */
  @media (max-width: 768px) {
    .content-grid {
      grid-template-columns: 1fr;
    }
    
    .booking-card {
      position: static;
    }
    
    .hotel-gallery {
      height: 250px;
    }
    
    .hotel-name {
      font-size: 1.5rem;
    }
    
    .price-amount {
      font-size: 2rem;
    }
    
    .amenities-grid {
      grid-template-columns: 1fr;
    }
    
    .gallery-thumbnails {
      max-width: 200px;
    }
    
    .thumbnail {
      width: 45px;
      height: 35px;
    }
  }

  .footer {
    background-color: #222;
    color: #fff;
    text-align: center;
    padding: 20px;
    margin-top: 40px;
  }
  </style>
</head>
<body>
  <div class="navbar">
    <img src="paygs.gif" alt="Paygo Logo">
    <a href="javascript:history.back()" class="back-btn">
      <i class="fas fa-arrow-right"></i>
      العودة للنتائج
    </a>
  </div>

  <div class="hotel-header">
    <div class="hotel-gallery">
      <img id="mainImage" class="main-image" src="" alt="صورة الفندق">
      <div class="gallery-thumbnails" id="thumbnails"></div>
      <div class="gallery-overlay" onclick="openGallery()">
        <i class="fas fa-images"></i>
        عرض جميع الصور
      </div>
    </div>
  </div>

  <div class="hotel-info-section">
    <div class="hotel-title">
      <h1 class="hotel-name" id="hotelName">جاري التحميل...</h1>
      <div class="hotel-rating">
        <span class="stars" id="hotelStars"></span>
        <span class="rating-score" id="hotelRating">-</span>
        <span id="reviewCount" style="color: #666;"></span>
      </div>
      <div class="hotel-location">
        <i class="fas fa-map-marker-alt"></i>
        <span id="hotelLocation">جاري التحميل...</span>
      </div>
    </div>

    <div class="content-grid">
      <div class="hotel-details">
        <h2 class="section-title">وصف الفندق</h2>
        <div class="hotel-description" id="hotelDescription">
          جاري تحميل وصف الفندق...
        </div>

        <h3 class="section-title">المرافق والخدمات</h3>
        <div class="amenities-grid" id="hotelAmenities">
          <!-- سيتم إدراج المرافق هنا -->
        </div>

        <div class="reviews-section">
          <h3 class="section-title">تقييمات النزلاء</h3>
          <div id="hotelReviews">
            <!-- سيتم إدراج التقييمات هنا -->
          </div>
        </div>

        <div class="map-section">
          <h3 class="section-title">الموقع</h3>
          <div class="map-placeholder">
            <i class="fas fa-map-marked-alt" style="margin-left: 10px;"></i>
            خريطة الموقع
          </div>
        </div>
      </div>

      <div class="booking-card">
        <div class="price-section">
          <div class="price-from">السعر يبدأ من</div>
          <div class="price-amount" id="hotelPrice">---</div>
          <div class="price-per-night">لليلة الواحدة شامل الضرائب</div>
        </div>

        <div class="booking-form">
          <div class="form-group">
            <label>تاريخ الوصول</label>
            <input type="date" class="form-control" id="checkinDate">
          </div>
          <div class="form-group">
            <label>تاريخ المغادرة</label>
            <input type="date" class="form-control" id="checkoutDate">
          </div>
          <div class="form-group">
            <label>عدد الضيوف</label>
            <select class="form-control" id="guestCount">
              <option value="1">1 ضيف</option>
              <option value="2">2 ضيف</option>
              <option value="3">3 ضيوف</option>
              <option value="4">4 ضيوف</option>
            </select>
          </div>
        </div>

        <button class="book-now-btn" onclick="proceedToBooking()">
          <i class="fas fa-calendar-check"></i>
          احجز الآن
        </button>

        <div style="text-align: center; margin-top: 15px; color: #666; font-size: 0.85rem;">
          <i class="fas fa-shield-alt"></i>
          حجز آمن ومضمون
        </div>
      </div>
    </div>
  </div>

  <!-- Modal المعرض -->
  <div class="gallery-modal" id="galleryModal">
    <div class="modal-content">
      <button class="modal-close" onclick="closeGallery()">&times;</button>
      <button class="modal-nav modal-prev" onclick="prevImage()">&#8249;</button>
      <img class="modal-image" id="modalImage" src="" alt="">
      <button class="modal-nav modal-next" onclick="nextImage()">&#8250;</button>
    </div>
  </div>

  <div class="footer">
    <p>جميع الحقوق محفوظة © Paygo 2025</p>
  </div>

  <script>
    const RAPIDAPI_KEY = 'ed731333c1mshea92aa884b20792p16f38ajsn52efc429d7bc';
    const RAPIDAPI_HOST = 'booking-com15.p.rapidapi.com';

    let hotelData = {};
    let currentImageIndex = 0;
    let hotelImages = [];

    // استخراج معاملات الفندق من URL
    function getHotelParams() {
      const urlParams = new URLSearchParams(window.location.search);
      return {
        hotelId: urlParams.get('hotelId') || '',
        hotelName: urlParams.get('hotelName') || '',
        checkin: urlParams.get('checkin') || '',
        checkout: urlParams.get('checkout') || '',
        adults: urlParams.get('adults') || '1'
      };
    }

    // تحميل تفاصيل الفندق
    async function loadHotelDetails() {
      const params = getHotelParams();
      
      if (!params.hotelId) {
        displayError('معرف الفندق غير صحيح');
        return;
      }

      try {
        // محاولة جلب تفاصيل الفندق من الـ API
        const response = await fetch(`https://${RAPIDAPI_HOST}/api/v1/hotels/getHotelDetails?hotel_id=${params.hotelId}&arrival_date=${params.checkin}&departure_date=${params.checkout}&adults=${params.adults}`, {
          method: 'GET',
          headers: {
            'x-rapidapi-key': RAPIDAPI_KEY,
            'x-rapidapi-host': RAPIDAPI_HOST
          }
        });

        if (response.ok) {
          const data = await response.json();
          if (data.data) {
            displayHotelDetails(data.data);
            return;
          }
        }

        // إذا فشل الـ API، استخدم البيانات الأساسية من URL
        displayBasicHotelInfo(params);

      } catch (error) {
        console.error('خطأ في تحميل تفاصيل الفندق:', error);
        displayBasicHotelInfo(getHotelParams());
      }
    }

    // عرض تفاصيل الفندق الكاملة
    function displayHotelDetails(hotel) {
      hotelData = hotel;
      
      // اسم الفندق
      document.getElementById('hotelName').textContent = hotel.hotel_name || 'اسم الفندق غير متوفر';
      
      // التقييم
      if (hotel.review_score) {
        const rating = (hotel.review_score / 2).toFixed(1);
        const starsCount = Math.round(hotel.review_score / 2);
        document.getElementById('hotelStars').textContent = '⭐'.repeat(Math.min(starsCount, 5));
        document.getElementById('hotelRating').textContent = rating;
      }
      
      if (hotel.review_nr) {
        document.getElementById('reviewCount').textContent = `(${hotel.review_nr} تقييم)`;
      }
      
      // الموقع
      document.getElementById('hotelLocation').textContent = hotel.address || 'الموقع غير محدد';
      
      // السعر
      if (hotel.price_breakdown && hotel.price_breakdown.gross_amount) {
        document.getElementById('hotelPrice').textContent = `${hotel.price_breakdown.gross_amount} ${hotel.price_breakdown.currency || 'USD'}`;
      }
      
      // الوصف
      document.getElementById('hotelDescription').textContent = hotel.description || 'وصف الفندق غير متوفر حالياً. يقدم هذا الفندق خدمات متميزة وإقامة مريحة للنزلاء مع مرافق عصرية وخدمة عملاء ممتازة.';
      
      // الصور
      setupImageGallery(hotel.photos || []);
      
      // المرافق
      setupAmenities(hotel.facilities || []);
      
      // التقييمات
      setupReviews(hotel.reviews || []);
    }

    // عرض المعلومات الأساسية للفندق
    function displayBasicHotelInfo(params) {
      document.getElementById('hotelName').textContent = decodeURIComponent(params.hotelName) || 'فندق مميز';
      document.getElementById('hotelLocation').textContent = 'موقع متميز في المدينة';
      document.getElementById('hotelDescription').textContent = 'فندق راقي يوفر إقامة مريحة مع خدمات متميزة ومرافق عصرية. يتميز بموقعه الاستراتيجي وخدمة العملاء الممتازة.';
      
      // صور افتراضية
      const defaultImages = [
        'https://images.unsplash.com/photo-1566073771259-6a8506099945?w=800',
        'https://images.unsplash.com/photo-1582719478250-c89cae4dc85b?w=800',
        'https://images.unsplash.com/photo-1571003123894-1f0594d2b5d9?w=800',
        'https://images.unsplash.com/photo-1578683010236-d716f9a3f461?w=800'
      ];
      
      setupImageGallery(defaultImages.map(url => ({ url_original: url })));
      setupDefaultAmenities();
      setupDefaultReviews();
    }

    // إعداد معرض الصور
    function setupImageGallery(photos) {
      hotelImages = photos.length > 0 ? photos : [
        { url_original: 'https://images.unsplash.com/photo-1566073771259-6a8506099945?w=800' },
        { url_original: 'https://images.unsplash.com/photo-1582719478250-c89cae4dc85b?w=800' },
        { url_original: 'https://images.unsplash.com/photo-1571003123894-1f0594d2b5d9?w=800' }
      ];
      
      // الصورة الرئيسية
      document.getElementById('mainImage').src = hotelImages[0].url_original;
      
      // الصور المصغرة
      const thumbnailsContainer = document.getElementById('thumbnails');
      thumbnailsContainer.innerHTML = '';
      
      hotelImages.slice(0, 5).forEach((photo, index) => {
        const thumbnail = document.createElement('img');
        thumbnail.src = photo.url_original;
        thumbnail.className = 'thumbnail' + (index === 0 ? ' active' : '');
        thumbnail.onclick = () => changeMainImage(index);
        thumbnailsContainer.appendChild(thumbnail);
      });
    }

    // تغيير الصورة الرئيسية
    function changeMainImage(index) {
      currentImageIndex = index;
      document.getElementById('mainImage').src = hotelImages[index].url_original;
      
      // تحديث الصور المصغرة
      document.querySelectorAll('.thumbnail').forEach((thumb, i) => {
        thumb.classList.toggle('active', i === index);
      });
    }

    // إعداد المرافق
    function setupAmenities(facilities) {
      const amenitiesContainer = document.getElementById('hotelAmenities');
      
      const defaultAmenities = [
        { icon: 'fas fa-wifi', name: 'واي فاي مجاني' },
        { icon: 'fas fa-swimming-pool', name: 'مسبح' },
        { icon: 'fas fa-dumbbell', name: 'صالة رياضية' },
        { icon: 'fas fa-car', name: 'مواقف سيارات' },
        { icon: 'fas fa-utensils', name: 'مطعم' },
        { icon: 'fas fa-concierge-bell', name: 'خدمة الغرف' },
        { icon: 'fas fa-spa', name: 'سبا ومنتجع صحي' },
        { icon: 'fas fa-business-time', name: 'مركز أعمال' }
      ];
      
      const amenities = facilities.length > 0 ? facilities : defaultAmenities;
      
      amenitiesContainer.innerHTML = amenities.map(amenity => `
        <div class="amenity-item">
          <i class="${amenity.icon || 'fas fa-check'} amenity-icon"></i>
          <span>${amenity.name || amenity}</span>
        </div>
      `).join('');
    }

    // إعداد المرافق الافتراضية
    function setupDefaultAmenities() {
      setupAmenities([]);
    }

    // إعداد التقييمات
    function setupReviews(reviews) {
      const reviewsContainer = document.getElementById('hotelReviews');
      
      const defaultReviews = [
        {
          reviewer_name: 'أحمد محمد',
          review_date: '2024-01-15',
          rating: 5,
          review_text: 'إقامة رائعة! الفندق نظيف جداً والخدمة ممتازة. الموقع مثالي والإطلالة جميلة.'
        },
        {
          reviewer_name: 'فاطمة علي',
          review_date: '2024-01-10',
          rating: 4,
          review_text: 'فندق جيد جداً، الغرف واسعة ومريحة. الإفطار متنوع ولذيذ. أنصح بالإقامة هنا.'
        },
        {
          reviewer_name: 'محمد السعيد',
          review_date: '2024-01-05',
          rating: 5,
          review_text: 'تجربة لا تُنسى! الطاقم ودود ومتعاون، والمرافق حديثة. سأعود بالتأكيد.'
        }
      ];
      
      const reviewsToShow = reviews.length > 0 ? reviews : defaultReviews;
      
      reviewsContainer.innerHTML = reviewsToShow.map(review => `
        <div class="review-item">
          <div class="review-header">
            <span class="reviewer-name">${review.reviewer_name || review.author}</span>
            <span class="review-date">${review.review_date || review.date}</span>
          </div>
          <div class="review-rating">
            ${'⭐'.repeat(review.rating || 5)}
          </div>
          <div class="review-text">${review.review_text || review.text}</div>
        </div>
      `).join('');
    }

    // إعداد التقييمات الافتراضية
    function setupDefaultReviews() {
      setupReviews([]);
    }

    // فتح معرض الصور
    function openGallery() {
      document.getElementById('galleryModal').style.display = 'flex';
      document.getElementById('modalImage').src = hotelImages[currentImageIndex].url_original;
    }

    // إغلاق معرض الصور
    function closeGallery() {
      document.getElementById('galleryModal').style.display = 'none';
    }

    // الصورة السابقة
    function prevImage() {
      currentImageIndex = (currentImageIndex - 1 + hotelImages.length) % hotelImages.length;
      document.getElementById('modalImage').src = hotelImages[currentImageIndex].url_original;
    }

    // الصورة التالية
    function nextImage() {
      currentImageIndex = (currentImageIndex + 1) % hotelImages.length;
      document.getElementById('modalImage').src = hotelImages[currentImageIndex].url_original;
    }

    // المتابعة للحجز
    function proceedToBooking() {
      const checkin = document.getElementById('checkinDate').value;
      const checkout = document.getElementById('checkoutDate').value;
      const guests = document.getElementById('guestCount').value;
      
      if (!checkin || !checkout) {
        alert('يرجى تحديد تواريخ الإقامة');
        return;
      }
      
      if (new Date(checkin) >= new Date(checkout)) {
        alert('تاريخ المغادرة يجب أن يكون بعد تاريخ الوصول');
        return;
      }
      
      // هنا يمكن إضافة منطق الحجز الفعلي
      alert(`تم تأكيد طلب الحجز!\n\nتفاصيل الحجز:\n- الفندق: ${document.getElementById('hotelName').textContent}\n- الوصول: ${checkin}\n- المغادرة: ${checkout}\n- عدد الضيوف: ${guests}\n\nسيتم التواصل معك قريباً لتأكيد الحجز.`);
    }

    // عرض رسالة خطأ
    function displayError(message) {
      document.getElementById('hotelName').textContent = 'خطأ في تحميل البيانات';
      document.getElementById('hotelLocation').textContent = message;
    }

    // تعيين التواريخ الافتراضية
    function setDefaultDates() {
      const params = getHotelParams();
      const today = new Date();
      const tomorrow = new Date(today);
      tomorrow.setDate(tomorrow.getDate() + 1);
      
      document.getElementById('checkinDate').value = params.checkin || today.toISOString().split('T')[0];
      document.getElementById('checkoutDate').value = params.checkout || tomorrow.toISOString().split('T')[0];
    }

    // تشغيل التطبيق عند تحميل الصفحة
    document.addEventListener('DOMContentLoaded', function() {
      setDefaultDates();
      loadHotelDetails();
      
      // إغلاق المعرض بالضغط على Escape
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
          closeGallery();
        }
      });
    });
  </script>
</body>
</html>

